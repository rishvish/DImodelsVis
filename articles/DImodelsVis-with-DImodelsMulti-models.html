<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using DImodelsVis with regression models fit using the `DImodelsMulti` R package • DImodelsVis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using DImodelsVis with regression models fit using the `DImodelsMulti` R package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using DImodelsVis with regression models fit using the `DImodelsMulti` R package</h1>
            
      

      <div class="d-none name"><code>DImodelsVis-with-DImodelsMulti-models.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="loading-necessary-packages">Loading necessary packages<a class="anchor" aria-label="anchor" href="#loading-necessary-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com/" class="external-link">DImodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rishvish.github.io/DImodelsVis/">DImodelsVis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com" class="external-link">DImodelsMulti</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-exploration">Data exploration<a class="anchor" aria-label="anchor" href="#data-exploration"></a>
</h3>
<div class="section level4">
<h4 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h4>
<p>This data (henceforward referred as <code>Belgium</code>) comes from
a BEF experiment conducted in Belgium as part of the wider
“Agrodiversity Experiment” <a href="https://doi.org/10.6084/m9.figshare.c.3307098.v1" class="external-link">Kirwan et al
2014</a>. In this study, thirty experimental plots were established with
one to four species (two grasses G1-G2 and legumes L1-L2), representing
fifteen plant communities, each sown at two seeding densities. Three
ecosystem function responses, namely DM yield (called
<code>Sown</code>), Weed suppression (called <code>Weed</code>) and
Nitrogen yield (called <code>N</code>) are recorded for each plot at a
single time point and stored in the column <code>Y</code>. The data is
available in the <a href="https://cran.r-project.org/package=DImodelsMulti" class="external-link"><code>DImodelsMulti</code></a>
R package and an analysis of the this dataset can be found in <a href="https://doi.org/10.1111/ele.12504" class="external-link">Dooley et al., 2015</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataBEL</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Plot  G1  G2  L1  L2 Density  Var VarNum       Y</span></span>
<span><span class="co">#&gt; 1    1 0.7 0.1 0.1 0.1       1 Sown      1 104.156</span></span>
<span><span class="co">#&gt; 2    1 0.7 0.1 0.1 0.1       1 Weed      2 100.058</span></span>
<span><span class="co">#&gt; 3    1 0.7 0.1 0.1 0.1       1    N      3  87.996</span></span>
<span><span class="co">#&gt; 4    2 0.1 0.7 0.1 0.1       1 Sown      1  82.547</span></span>
<span><span class="co">#&gt; 5    2 0.1 0.7 0.1 0.1       1 Weed      2  89.801</span></span>
<span><span class="co">#&gt; 6    2 0.1 0.7 0.1 0.1       1    N      3  72.239</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<p>We fit the average pairwise Diversity-Interactions model to all three
ecosystem functions in the <code>Belgium</code> dataset using the
<code><a href="https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html" class="external-link">DImulti()</a></code> function from the <code>DImodelsMulti</code>
package. The main benefit of fitting a single model for all responses is
that it allows us to capture covariances between the ecosystem
functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Name of compositional predictors (species)</span></span>
<span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span></span>
<span><span class="co"># Functional groupings of species</span></span>
<span><span class="va">FG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gr"</span>, <span class="st">"Gr"</span>, <span class="st">"Le"</span>, <span class="st">"Le"</span><span class="op">)</span></span>
<span><span class="co"># Colours to be used for pie-glyphs for all figures</span></span>
<span><span class="va">pie_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_colours.html">get_colours</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="va">species</span>, FG <span class="op">=</span> <span class="va">FG</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html" class="external-link">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">species</span>, FG <span class="op">=</span> <span class="va">FG</span>, y <span class="op">=</span> <span class="st">"Y"</span>, </span>
<span>                 eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var"</span>, <span class="st">"un"</span><span class="op">)</span>,</span>
<span>                 unit_IDs <span class="op">=</span> <span class="st">"Plot"</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"REML"</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span></code></pre></div>
<p>The model coefficients are as follows</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Note: </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">REML</span><span style="font-weight: bold;"> </span></span></span>
<span><span class="co"><span style="font-weight: bold;">#&gt; </span><span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">un</span></span></span>
<span><span class="co">#&gt;  <span style="color: #00BB00; font-weight: bold;">Average Term Model</span></span></span>
<span><span class="co"><span style="color: #BB00BB; font-weight: bold;">#&gt; Theta value(s) = </span>1,1,1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generalized least squares fit by REML</span></span>
<span><span class="co">#&gt;   Model: Y ~ 0 + Var:((G1_ID + G2_ID + L1_ID + L2_ID + AV)) </span></span>
<span><span class="co">#&gt;       AIC       BIC    logLik </span></span>
<span><span class="co">#&gt;  560.2461  608.9134 -259.1231 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Multivariate Correlation Structure: General</span></span>
<span><span class="co">#&gt;  Formula: ~0 | Plot </span></span>
<span><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span><span class="co">#&gt;  Correlation: </span></span>
<span><span class="co">#&gt;   1      2     </span></span>
<span><span class="co">#&gt; 2  0.738       </span></span>
<span><span class="co">#&gt; 3 -0.175  0.386</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 Beta      Std. Error   t-value   p-value     Signif </span></span>
<span><span class="co">#&gt; --------------  --------  -----------  --------  ----------  -------</span></span>
<span><span class="co">#&gt; VarN:G1_ID      +49.113   4.966        9.889     3.091e-15   ***    </span></span>
<span><span class="co">#&gt; VarSown:G1_ID   +67.548   4.176        16.174    3.662e-26   ***    </span></span>
<span><span class="co">#&gt; VarWeed:G1_ID   +75.241   8.341        9.020     1.362e-13   ***    </span></span>
<span><span class="co">#&gt; VarN:G2_ID      +33.173   4.966        6.679     3.682e-09   ***    </span></span>
<span><span class="co">#&gt; VarSown:G2_ID   +49.019   4.176        11.737    1.182e-18   ***    </span></span>
<span><span class="co">#&gt; VarWeed:G2_ID   +86.523   8.341        10.373    3.826e-16   ***    </span></span>
<span><span class="co">#&gt; VarN:L1_ID      +93.338   4.966        18.794    4.283e-30   ***    </span></span>
<span><span class="co">#&gt; VarSown:L1_ID   +76.145   4.176        18.233    2.777e-29   ***    </span></span>
<span><span class="co">#&gt; VarWeed:L1_ID   +54.803   8.341        6.570     5.871e-09   ***    </span></span>
<span><span class="co">#&gt; VarN:L2_ID      +72.159   4.966        14.529    1.669e-23   ***    </span></span>
<span><span class="co">#&gt; VarSown:L2_ID   +50.810   4.176        12.166    1.999e-19   ***    </span></span>
<span><span class="co">#&gt; VarWeed:L2_ID   +38.722   8.341        4.642     1.437e-05   ***    </span></span>
<span><span class="co">#&gt; VarN:AV         +67.685   10.827       6.251     2.263e-08   ***    </span></span>
<span><span class="co">#&gt; VarSown:AV      +86.495   9.104        9.500     1.674e-14   ***    </span></span>
<span><span class="co">#&gt; VarWeed:AV      +83.296   18.184       4.581     1.809e-05   ***    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of freedom: 90 total; 75 residual</span></span>
<span><span class="co">#&gt; Residual standard error: 8.271401 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;            N   Sown    Weed</span></span>
<span><span class="co">#&gt; N     68.416 42.450 -20.059</span></span>
<span><span class="co">#&gt; Sown  42.450 48.377  37.290</span></span>
<span><span class="co">#&gt; Weed -20.059 37.290 192.990</span></span>
<span><span class="co">#&gt;   Standard Deviations: 8.2714 6.9554 13.892</span></span></code></pre></div>
<p>The average interaction effect is significant for all three ecosystem
functions. Additionally, sown is positively correlated with the other
two ecosystem functions while Weed and N are negatively correlated.</p>
</div>
<div class="section level3">
<h3 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h3>
<p>The model diagnostics function works directly with
<code>DImodelsMulti</code> model object. However, only the
<code>"Pearson Residual vs Fitted"</code> and
<code>"Qunatile-Quantile"</code> plots can be created for these
models.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/model_diagnostics.html">model_diagnostics</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/model-diagnostics1-1.png" alt="Output from model_diagnostics() function" width="768" style="display: block; margin: auto;"></p>
<p>There don’t seem to be any strong violations of any model
assumptions. The pie-glyphs indicate that mixture perform higher than
the monocultures across the board.</p>
<p>By default, all ecosystem functions are plotted in the same panel,
however it is also possible to view them in separate panels as
follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/model_diagnostics.html">model_diagnostics</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Var</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/model-diagnostics2-1.png" alt="Output from model_diagnostics() function" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="model-interpretation">Model interpretation<a class="anchor" aria-label="anchor" href="#model-interpretation"></a>
</h3>
<p>All the visualisation functions aiding with model interpretation in
<code>DImodelsVis</code> integrate smoothly with statistical model
objects fit using <code>DImodelsMulti</code>. The visualisations are
automatically split into separate panels for each ecosystem function (or
time-point) in the model by default. However, users also have the option
to create the visualisations for only specific ecosystem functions (or
time-points) if they desire.</p>
<div class="section level4">
<h4 id="gradient-change-plot">Gradient-change plot<a class="anchor" aria-label="anchor" href="#gradient-change-plot"></a>
</h4>
<p>We depict the average BEF relationship with respect to species
richness for all three ecosystem functions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grad_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_equi_comms.html">get_equi_comms</a></span><span class="op">(</span><span class="fl">4</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="st">"Rich."</span> <span class="op">=</span> <span class="va">Richness</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gradient_change.html">gradient_change</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, data <span class="op">=</span> <span class="va">grad_data</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/gradient-change-1.png" alt="Output from gradient_change() function" width="1152" style="display: block; margin: auto;"></p>
<p>The BEF relationship observed across all three ecosystem functions
exhibits the characteristic saturating shape, where gains in function
diminish as diversity increases.</p>
</div>
<div class="section level4">
<h4 id="conditional-ternary-plot">Conditional ternary plot<a class="anchor" aria-label="anchor" href="#conditional-ternary-plot"></a>
</h4>
<p>We create conditional ternary diagram with the proportion of L1 fixed
to be 0, 0.25, and 0.5.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/conditional_ternary.html">conditional_ternary</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                    tern_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L2"</span><span class="op">)</span>,</span>
<span>                    conditional <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>L1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    lower_lim <span class="op">=</span> <span class="fl">30</span>, upper_lim <span class="op">=</span> <span class="fl">110</span>, nlevels <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                    nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/cond-tern-1.png" alt="Output from conditional_ternary() function" width="768" style="display: block; margin: auto;"></p>
<p>The prediction for DM and nitrogen yield proportion of L1 increases
to 0.5, while that of weed suppression decreases.</p>
</div>
<div class="section level4">
<h4 id="grouped-ternary-plot">Grouped ternary plot<a class="anchor" aria-label="anchor" href="#grouped-ternary-plot"></a>
</h4>
<p>We create a grouped ternary plot where the two grasses are grouped
together and the total grasses proportion is split equally between G1
and G2. Additionally, till now we have been using the default option of
showing the visualisations for each ecosystem function. As an example,
to showcase how this can be changed, we will only show the plots for
nitrogen yield and weed suppression in this example. However, note that
this would be possible to do with any visualisation in the package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grouped_ternary.html">grouped_ternary</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span>,</span>
<span>                <span class="co"># Split of species within each group</span></span>
<span>                values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                lower_lim <span class="op">=</span> <span class="fl">30</span>, upper_lim <span class="op">=</span> <span class="fl">110</span>, nlevels <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Var"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"Weed"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Arrange in two rows</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/grouped-tern-1.png" alt="Output from grouped_ternary() function" width="384" style="display: block; margin: auto;"></p>
<p>The visualisation very clearly shows the trade-off between weed
suppression and nitrogen yield as weed suppression is maximised by
increasing the proportion of grasses while nitrogen yield is maximised
by increases the proportion of legumes.</p>
</div>
<div class="section level4">
<h4 id="effects-plot">Effects plot<a class="anchor" aria-label="anchor" href="#effects-plot"></a>
</h4>
<p>We visualise the effect of adding L1 and L2 to several
equi-proportional mixtures on each ecosystem function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eff_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_equi_comms.html">get_equi_comms</a></span><span class="op">(</span><span class="fl">4</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/visualise_effects.html">visualise_effects</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, data <span class="op">=</span> <span class="va">eff_data</span>, </span>
<span>                  var_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span>, </span>
<span>                  <span class="co"># arrange plot in three row (one for each function)</span></span>
<span>                  nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/effects-plot-1.png" alt="Output from visualise_effects() function" width="576" style="display: block; margin: auto;"></p>
<p>This figure shows that no single species maximizes all three
ecosystem functions. For example, increasing the proportion of L1
improves dry matter and nitrogen yield but leads to a marked reduction
in weed suppression.</p>
</div>
<div class="section level4">
<h4 id="simplex-path-plot">Simplex path plot<a class="anchor" aria-label="anchor" href="#simplex-path-plot"></a>
</h4>
<p>We depict the change in the predicted response as we move from the
four-species centroid community towards each binary two-species
mixture.</p>
<p>In addition to the standard arguments, we also show how one can
create multiple plots for different levels of any non-compositional
experimental treatments in the data (if used as predictors in the
model). For example, suppose we had used Density as a predictor in the
model and wished to visualise how does performance differ across the two
seeding density levels, one could do it as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The centroid community (starting point for the straight line)</span></span>
<span><span class="va">starts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span> <span class="op">~</span><span class="va">G1</span>,  <span class="op">~</span><span class="va">G2</span>,  <span class="op">~</span><span class="va">L1</span>,  <span class="op">~</span><span class="va">L2</span>,</span>
<span>                  <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="co"># The six binary mixtures (ending points for the straight lines)</span></span>
<span><span class="va">ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">G1</span>,    <span class="op">~</span><span class="va">G2</span>,  <span class="op">~</span><span class="va">L1</span>,  <span class="op">~</span><span class="va">L2</span>,</span>
<span>                  <span class="fl">0.5</span>,  <span class="fl">0.5</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,</span>
<span>                  <span class="fl">0.5</span>,    <span class="fl">0</span>,  <span class="fl">0.5</span>,    <span class="fl">0</span>,</span>
<span>                  <span class="fl">0.5</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,  <span class="fl">0.5</span>,</span>
<span>                    <span class="fl">0</span>,  <span class="fl">0.5</span>,  <span class="fl">0.5</span>,    <span class="fl">0</span>,</span>
<span>                    <span class="fl">0</span>,  <span class="fl">0.5</span>,    <span class="fl">0</span>,  <span class="fl">0.5</span>,</span>
<span>                    <span class="fl">0</span>,    <span class="fl">0</span>,  <span class="fl">0.5</span>,  <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the visualisation</span></span>
<span><span class="fu"><a href="../reference/simplex_path.html">simplex_path</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>,</span>
<span>             starts <span class="op">=</span> <span class="va">starts</span>, ends <span class="op">=</span> <span class="va">ends</span>,</span>
<span>             <span class="co"># Manually specify to create plot for Weed and N</span></span>
<span>             add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Density"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,                nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/simplex-path-1.png" alt="Output from simplex_path() function" width="960" style="display: block; margin: auto;"></p>
<p>In this example, density was not included as a predictor in the
model, so the two panels at different density levels appear identical.
Nonetheless, the same approach could be applied in other situations when
any other non-compositional variable is used as a predictor to visualise
performance, across its different values. Importantly, this flexibility
extends to any visualisation within the package. Furthermore, note that
this would be possible to do with any visualisation in the package as
well.</p>
</div>
<div class="section level4">
<h4 id="prediction-contributions-plot">Prediction contributions plot<a class="anchor" aria-label="anchor" href="#prediction-contributions-plot"></a>
</h4>
<p>Currently, the prediction contributions plot does not work directly
with a <code>DImulti</code> object. However, this functionality will
soon be added. For the time being, here is how the prediction
contributions plot can be created for a <code>DImulti</code> model.</p>
<p>These steps should be followed: 1. Create a data.frame containing the
species communities for which you wish to visualise prediction
contributions and a column containing names of the ecosystem functions
for which you wish to generate predictions (the
<code><a href="../reference/add_add_var.html">add_add_var()</a></code> function helps with this). Ensure this data
also contains any other additional predictors from the model such as
nitrogen treatment, seeding density, etc. 2. Prepare the data needed for
the prediction contributions plot using the
<code><a href="../reference/prediction_contributions_data.html">prediction_contributions_data()</a></code> function. The important
steps here is to create a manual grouping for the coefficients using the
<code>coeff_groups</code> parameter ensuring that identical coefficients
repeated across functions are assigned the same group and thus share a
single colour in the plot. For example, the G1 identity effect (G1_ID)
or the average interaction effect (AV) across all three ecosystem
functions are grouped to be a single term. This grouping can be done
either by coefficient indices or their names and it is not mandatory to
group all coefficients. The user can decide a grouping that best suits
their example. 3. Pass the prepared data to the
<code><a href="../reference/prediction_contributions_plot.html">prediction_contributions_plot()</a></code> function to visualise the
prediction contributions.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_equi_comms.html">get_equi_comms</a></span><span class="op">(</span><span class="fl">4</span>, richness_lvl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                            variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1_mono"</span>, <span class="st">"G1_mono"</span>, <span class="st">"G1_mono"</span>, <span class="st">"L2_mono"</span>,</span>
<span>                    <span class="st">"G1-G2"</span>, <span class="st">"G1-L1"</span>, <span class="st">"G1-L2"</span>, <span class="st">"G2-L1"</span>, <span class="st">"G2-L2"</span>, <span class="st">"L1-L2"</span>,</span>
<span>                    <span class="st">"Centroid"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Repeat each community across the three ecosystem functions</span></span>
<span>  <span class="fu"><a href="../reference/add_add_var.html">add_add_var</a></span><span class="op">(</span>add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Var"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"Sown"</span>, <span class="st">"Weed"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>G1_ID <span class="op">=</span> <span class="va">G1</span>, G2_ID <span class="op">=</span> <span class="va">G2</span>, L1_ID <span class="op">=</span> <span class="va">L1</span>, L2_ID <span class="op">=</span> <span class="va">L2</span>,</span>
<span>         AV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI_data_manipulation.html" class="external-link">DI_data_E_AV</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">$</span><span class="va">AV</span>,</span>
<span>         <span class="st">"Rich."</span> <span class="op">=</span> <span class="va">Richness</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/prediction_contributions_data.html">prediction_contributions_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pred_data</span>, model <span class="op">=</span> <span class="va">model</span>, </span>
<span>                              bar_labs <span class="op">=</span> <span class="st">"labels"</span>,</span>
<span>                              <span class="co"># Important to group the coefficients</span></span>
<span>                              groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G1"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"G2"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>                                            <span class="st">"L1"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">9</span>, <span class="st">"L2"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>                                            <span class="st">"AV"</span> <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/prediction_contributions_plot.html">prediction_contributions_plot</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pie_cols</span>, <span class="st">"steelblue3"</span><span class="op">)</span>,</span>
<span>                                nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Rich.</span>, scale <span class="op">=</span> <span class="st">"free_x"</span>, space <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1.1</span>, vjust <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImodelsVis-with-DImodelsMulti-models_files/figure-html/pred-cont-1.png" alt="Output from prediction_contributions_plot() function" width="768" style="display: block; margin: auto;"></p>
<p>The best performing monoculture differs across the three ecosystem
function. However, the four species centroid mixture containing 25% of
each species performs comparably or out-performs the best monoculture
for each ecosystem function.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rishabh Vishwakarma, Caroline Brophy, Laura Byrne, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
