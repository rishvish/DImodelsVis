<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualising and Interpreting Statistical Models Fit to Compositional Data • DImodelsVis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Visualising and Interpreting Statistical Models Fit to Compositional Data">
<meta name="description" content="Statistical models fit to compositional data are often difficult to interpret due to the sum to 1 constraint on data variables. DImodelsVis provides novel visualisations tools to aid with the interpretation of models fit to compositional data. All visualisations in the package are created using the ggplot2 plotting framework and can be extended like every other ggplot object.">
<meta property="og:description" content="Statistical models fit to compositional data are often difficult to interpret due to the sum to 1 constraint on data variables. DImodelsVis provides novel visualisations tools to aid with the interpretation of models fit to compositional data. All visualisations in the package are created using the ggplot2 plotting framework and can be extended like every other ggplot object.">
<meta property="og:image" content="https://rishvish.github.io/DImodelsVis/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">DImodelsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="dimodelsvis-">DImodelsVis <a class="anchor" aria-label="anchor" href="#dimodelsvis-"></a>
</h1>
</div>
<!-- badges: start -->

<p>Statistical models fit to compositional data are often difficult to interpret due to the sum to one constraint on data variables. <code>DImodelsVis</code> provides novel visualisations tools to aid with the interpretation for models where the predictor space is compositional in nature. All visualisations in the package are created using the <code>ggplot2</code> plotting framework and can be extended like every other ggplot object.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of <code>DImodelsVis</code> from <a href="https://cran.r-project.org/" class="external-link">CRAN</a> by running:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"DImodelsVis"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of <code>DImodelsVis</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"rishvish/DImodelsVis"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
<div class="section level3">
<h3 id="introduction-to-diversity-interactions-di-models">Introduction to Diversity-Interactions (DI) models:<a class="anchor" aria-label="anchor" href="#introduction-to-diversity-interactions-di-models"></a>
</h3>
<p>While sometimes it is of interest to model a compositional data response, there are times when the predictors of a response are compositional, rather than the response itself. Diversity-Interactions (DI) models (<a href="doi:10.1890/08-1684.1">Kirwan et al., 2009</a>, <a href="doi:10.1111/1365-2745.12052">Connolly et al., 2013</a>, <a href="doi:10.1111/2041-210X.14158">Moral et al., 2023</a>) are a regression based modelling technique for analysing and interpreting data from biodiversity experiments that explore the effects of species diversity on the different outputs (called ecosystem functions) produced by an ecosystem. Traditional techniques for analysing diversity experiments quantify species diversity in terms of species richness (i.e., the number of species present in a community). The DI method builds on top of this richness approach by taking the relative abundances of the species within in the community into account, thus the predictors in the model are compositional in nature. The DI approach can differentiate among different species identities as well as between communities with same set of species but with different relative proportions, thereby enabling us to better capture the relationship between diversity and ecosystem functions within an ecosystem. The <a href="https://cran.r-project.org/package=DImodels" class="external-link"><code>DImodels</code></a> and <a href="https://cran.r-project.org/package=DImodelsMulti" class="external-link"><code>DImodelsMulti</code></a> R packages are available to aid the user in fitting these models. The <code>DImodelsVis</code> (DI models Visualisation) package is a complimentary package for visualising and interpreting the results from these models. However, the package is versatile and can be used with any standard statistical model object in R where the predictor space is compositional in nature.</p>
</div>
<div class="section level3">
<h3 id="package-map">Package Map<a class="anchor" aria-label="anchor" href="#package-map"></a>
</h3>
<div style="display: block; margin-left: auto; margin-right: auto;  width: 60%; max-width:75;">
<figure><img src="reference/figures/DImodelsVisWorkflowPackage.png" alt="Package workflow"><figcaption aria-hidden="true">
Package workflow
</figcaption></figure>
</div>
<p>The functions in the package can be categorised as functions for visualising model selection and validation or functions to aid with model interpretation. Here is a list of important visualisation functions present in the package along with a short description.</p>
<div class="section level4">
<h4 id="model-selection-and-validation">Model selection and validation<a class="anchor" aria-label="anchor" href="#model-selection-and-validation"></a>
</h4>
<ul>
<li>
<strong><code>model_diagnostics</code></strong>: Create diagnostics plots for a statistical model with the additional ability to overlay the points with <a href="https://cran.r-project.org/package=PieGlyph" class="external-link">pie-glyphs</a> showing the proportions of the compositional predictor variables.</li>
<li>
<strong><code>model_selection</code></strong>: Show a visual comparison of selection criteria of different models. Can also show the split of an information criteria into deviance and penalty components to visualise why a parsimonious model would be preferable over a complex one.</li>
</ul>
</div>
<div class="section level4">
<h4 id="model-interpretation">Model interpretation<a class="anchor" aria-label="anchor" href="#model-interpretation"></a>
</h4>
<ul>
<li>
<strong><code>prediction_contributions</code></strong>: The predicted response for observations is visualised as a stacked bar-chart showing the contributions of each term in the regression model.</li>
<li>
<strong><code>gradient_change</code></strong>: The predicted response for specific observations are shown using pie-glyphs along with the average change in the predicted response over the richness or evenness diversity gradients.</li>
<li>
<strong><code>conditional_ternary</code></strong>: Assuming we have <code>n</code> compositional variables, fix <code>n-3</code> variables to have specific values and visualise the change in the predicted response across the remaining three variables as a contour plot in a ternary diagram.</li>
<li>
<strong><code>visualise_effects</code></strong>: Visualise the effect of increasing or decreasing a predictor variable (from a set of compositional predictor variables) on the predicted response whilst keeping the ratio of the other <code>n-1</code> compositional predictor variables constant.</li>
<li>
<strong><code>simplex_path</code></strong>: Visualise the change in the predicted response along a straight line between two points in the simplex space.</li>
</ul>
</div>
<div class="section level4">
<h4 id="other-utility-functions">Other utility functions<a class="anchor" aria-label="anchor" href="#other-utility-functions"></a>
</h4>
<ul>
<li>
<strong><code>add_prediction</code></strong>: A utility function to add prediction and associated uncertainty to data using a statistical model object or raw model coefficients.</li>
<li>
<strong><code>get_equi_comms</code></strong>: Utility function to create all possible combinations of equi-proportional communities at a given level of richness from a set of n compositional variables.</li>
<li>
<strong><code>custom_filter</code></strong>: A handy wrapper around the dplyr <a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link"><code>filter()</code></a> function enabling the user to filter rows which satisfy specific conditions for compositional data like all equi-proportional communities, or communities with a given value of richness without having to make any changes to the data or adding any additional columns.</li>
<li>
<strong><code>prop_to_tern_proj</code></strong> and <strong><code>tern_to_prop_proj</code></strong>: Helper functions for converting between 3-d compositional data and their 2-d projection.<br>
</li>
<li>
<strong><code>ternary_data</code></strong> and <strong><code>ternary_plot</code></strong>: Visualise the change in the predicted response across a set of three compositional predictor variables as a contour map within a ternary diagram.</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="load-libraries">Load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com/" class="external-link">DImodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rishvish.github.io/DImodelsVis/">DImodelsVis</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<p>This dataset originates from a grassland biodiversity experiment conducted in Switzerland as part of the “Agrodiversity Experiment” <a href="doi:10.6084/m9.figshare.c.3307098.v1">Kirwan et al 2014</a>. In this study, 68 grassland plots consisting of 1 to 4 species were established across a gradient of species diversity. The proportions of four species were varied across the plots: there were plots with 100% of a single species (called the monoculture of a species), and 2- and 4-species mixtures with varying proportions (e.g., (0.5, 0.5, 0, 0) and (0.7, 0.1, 0.1, 0.1)). Nitrogen fertilizer (at 50 or 150 kg/ha/yr) and seeding density (low or high) treatments were also manipulated across the plots. The total annual yield per plot was recorded for the first year after establishment. The data is available in the <a href="https://cran.r-project.org/package=DImodels" class="external-link"><code>DImodels</code></a> R package. An analysis of the this dataset can be found in <a href="doi:10.1890/08-1684.1">Kirwan et al., 2009</a>. For our example we only consider the plots that received the 150 kg nitrogen treatment. The four species proportions form our compositional predictors while the annual yield is our continuous response.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Switzerland</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="va">Switzerland</span><span class="op">[</span><span class="va">Switzerland</span><span class="op">$</span><span class="va">nitrogen</span> <span class="op">==</span> <span class="fl">150</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   plot nitrogen density   p1   p2   p3   p4    yield</span></span>
<span><span class="co">#&gt; 1    1      150    high 0.70 0.10 0.10 0.10 13.51823</span></span>
<span><span class="co">#&gt; 2    2      150    high 0.10 0.70 0.10 0.10 13.16549</span></span>
<span><span class="co">#&gt; 3    3      150    high 0.10 0.10 0.70 0.10 19.95682</span></span>
<span><span class="co">#&gt; 4    4      150    high 0.10 0.10 0.10 0.70 17.93976</span></span>
<span><span class="co">#&gt; 5    5      150    high 0.25 0.25 0.25 0.25 13.74719</span></span>
<span><span class="co">#&gt; 6    6      150    high 0.40 0.40 0.10 0.10 15.11899</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-model-with-compositional-data">Fit model with compositional data<a class="anchor" aria-label="anchor" href="#fit-model-with-compositional-data"></a>
</h3>
<p>We fit different models with different interaction structures as described in <a href="doi:10.1111/2041-210X.14158">Moral et al., 2023</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"yield"</span>, prop <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">7</span>, </span>
<span>             DImodel <span class="op">=</span> <span class="st">"ID"</span>, data <span class="op">=</span> <span class="va">my_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitted model: Species identity 'ID' DImodel</span></span>
<span><span class="va">mod_AV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"yield"</span>, prop <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>             DImodel <span class="op">=</span> <span class="st">"AV"</span>, data <span class="op">=</span> <span class="va">my_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitted model: Average interactions 'AV' DImodel</span></span>
<span><span class="va">mod_FG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"yield"</span>, prop <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>             DImodel <span class="op">=</span> <span class="st">"FG"</span>, data <span class="op">=</span> <span class="va">my_data</span>,</span>
<span>             FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"H"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitted model: Functional group effects 'FG' DImodel</span></span>
<span><span class="va">mod_ADD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"yield"</span>, prop <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>             DImodel <span class="op">=</span> <span class="st">"ADD"</span>, data <span class="op">=</span> <span class="va">my_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitted model: Additive species contributions to interactions 'ADD' DImodel</span></span>
<span><span class="va">mod_FULL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"yield"</span>, prop <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>             DImodel <span class="op">=</span> <span class="st">"FULL"</span>, data <span class="op">=</span> <span class="va">my_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitted model: Separate pairwise interactions 'FULL' DImodel</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-selection-and-validation-1">Model selection and validation<a class="anchor" aria-label="anchor" href="#model-selection-and-validation-1"></a>
</h3>
<div class="section level4">
<h4 id="visualising-model-selection">Visualising model selection<a class="anchor" aria-label="anchor" href="#visualising-model-selection"></a>
</h4>
<p>We can visualise model selection by passing our models as a list to the <code>model_selection</code> function and visualising the best performing metric across different information criteria. Run <code><a href="reference/model_selection.html">?model_selection</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on customising the plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ID"</span> <span class="op">=</span> <span class="va">mod_ID</span>, <span class="st">"AV"</span> <span class="op">=</span> <span class="va">mod_AV</span>, <span class="st">"FG"</span> <span class="op">=</span> <span class="va">mod_FG</span>, </span>
<span>            <span class="st">"ADD"</span> <span class="op">=</span> <span class="va">mod_ADD</span>, <span class="st">"FULL"</span> <span class="op">=</span> <span class="va">mod_FULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/model_selection.html">model_selection</a></span><span class="op">(</span>models <span class="op">=</span> <span class="va">mods</span>, metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"AICc"</span>, <span class="st">"BIC"</span>, <span class="st">"BICc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-model-selection-1.png" alt="Output from model_selection() function" style="display: block; margin: auto;"></p>
<p>The model <code>mod_FG</code> (labelled as “FG”) is the best model as it has the lowest value for all the information criteria. We proceed with this model.</p>
<p>The coefficients are as follows</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_FG</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = fmla, family = family, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;            Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; p1_ID        8.5406     0.7627  11.198 2.50e-14 ***</span></span>
<span><span class="co">#&gt; p2_ID        8.7926     0.7627  11.528 9.70e-15 ***</span></span>
<span><span class="co">#&gt; p3_ID       16.0825     0.7627  21.086  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; p4_ID       11.9263     0.7627  15.637  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; FG_bfg_G_H  17.3817     2.1713   8.005 4.66e-10 ***</span></span>
<span><span class="co">#&gt; FG_wfg_G     7.6604     4.4234   1.732   0.0905 .  </span></span>
<span><span class="co">#&gt; FG_wfg_H     1.0119     4.4234   0.229   0.8201    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 2.370592)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 10290.75  on 50  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:   101.94  on 43  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 193.51</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h4>
<p>After choosing a model we can create diagnostics plot where the points are replaced by pie-glyphs showing the proportions of the compositional variables. Run <code><a href="reference/model_diagnostics.html">?model_diagnostics</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on customising the plot.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/model_diagnostics.html">model_diagnostics</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod_FG</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Created all plots.</span></span></code></pre></div>
<p><img src="reference/figures/README-model-diagnostics-1.png" alt="Output from model_diagnostics() function" style="display: block; margin: auto;"></p>
<p>Replacing the points with pie-glyphs could help us to quickly identify any problematic observations in the model. For example, we can see here that the diagnostics plots look fine and no assumptions seem to be violated. However, we can quickly spot that the all monocultures (communities with only 1 species) and certain communities with 2 species have high leverage values compared to all other communities in the data.</p>
</div>
</div>
<div class="section level3">
<h3 id="model-interpretation-1">Model interpretation<a class="anchor" aria-label="anchor" href="#model-interpretation-1"></a>
</h3>
<div class="section level4">
<h4 id="predictor-contributions-to-predicted-response">Predictor contributions to predicted response<a class="anchor" aria-label="anchor" href="#predictor-contributions-to-predicted-response"></a>
</h4>
<p>We visualise the predicted response for specific observations as a stacked bar-chart showing the contribution (predictor coefficient * predictor value) of each term in the model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/prediction_contributions.html">prediction_contributions</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod_FG</span>, </span>
<span>                         data <span class="op">=</span> <span class="va">my_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">12</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Finished data preparation.</span></span>
<span><span class="co">#&gt; ✔ Created plot.</span></span></code></pre></div>
<p><img src="reference/figures/README-prediction-contributions-1.png" alt="Output from prediction_contributions() function" style="display: block; margin: auto;"></p>
<p>The coloured bars show the contributions of the different terms in the model. The contribution is defined as the product of the coefficient and value for each predictor variable. Thus, the contribution for a term would be zero if it’s value in an observation is zero regardless of it’s coefficient value (e.g. prediction bars for the monocultures at the right of the graph).</p>
<p>This plot would aid in understanding why certain observations have higher predictions. For example, we can see that higher predictions are primarily driven by the <code>p3_ID</code> and <code>p4_ID</code> terms and hence the <code>p1</code> and <code>p2</code> monocultures have low predictions as the all the other terms have a value of zero here. Similarly, we can also see that mixtures dominated by <code>p3</code> perform the best. Run <code><a href="reference/prediction_contributions.html">?prediction_contributions</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on creating and customising the plot.</p>
</div>
<div class="section level4">
<h4 id="average-change-in-respone-over-diversity-gradient">Average change in respone over diversity gradient<a class="anchor" aria-label="anchor" href="#average-change-in-respone-over-diversity-gradient"></a>
</h4>
<p>Next we show a scatterplot of the predicted response across all equi-proportional mixtures at each level of richness (number of species in a community). The points are replaced with pie-glyphs to show the proportions of the different species while the dashed black line shows the average change in response over the richness gradient.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data including all equi-proportional communities at </span></span>
<span><span class="co"># each level of richness</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_equi_comms.html">get_equi_comms</a></span><span class="op">(</span>nvars <span class="op">=</span> <span class="fl">4</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Show the average change over richness</span></span>
<span><span class="fu"><a href="reference/gradient_change.html">gradient_change</a></span><span class="op">(</span><span class="va">mod_FG</span>, data <span class="op">=</span> <span class="va">plot_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Finished data preparation</span></span>
<span><span class="co">#&gt; ✔ Created plot.</span></span></code></pre></div>
<p><img src="reference/figures/README-gradient-change-1.png" alt="Output from gradient_change() function" style="display: block; margin: auto;"></p>
<p>This shows that on average the predicted response increases as richness increases but at a saturating rate. Run <code><a href="reference/gradient_change.html">?gradient_change</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on creating and customising the plot.</p>
</div>
<div class="section level4">
<h4 id="conditional-ternary-diagrams">Conditional ternary diagrams<a class="anchor" aria-label="anchor" href="#conditional-ternary-diagrams"></a>
</h4>
<p>Ternary diagrams are a great tool for visualising the change in a continuous response, however they can only be created for examples with three compositional variables. If we have more than three compositional variables we create conditional ternary diagrams where fix n-3 compositional variables to have specific values and visualise the change in the predicted response across the remaining three variables as a contour plot in a ternary diagram.</p>
<p>For this example, since we have four species we can condition one of the species (say <code>p2</code>) to have a specific values 0.2, 0.5, and 0.8 and see how the response is affected as we change the proportions of the other three species whilst ensuring that the sum of the four species proportions is 1.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/conditional_ternary.html">conditional_ternary</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod_FG</span>, </span>
<span>                    tern_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span>
<span>                    conditional <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"p2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Finished data preparation.</span></span>
<span><span class="co">#&gt; ✔ Created plot.</span></span></code></pre></div>
<p><img src="reference/figures/README-cond-ternary-1.png" alt="Output from conditional_ternary() function" style="display: block; margin: auto;"></p>
<p>This figure shows that the predicted response decreases as we increase the proportion of <code>p2</code> and is maximised as we increase the proportion of <code>p3</code>. Run <code><a href="reference/conditional_ternary.html">?conditional_ternary</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on creating and customising the plot.</p>
</div>
<div class="section level4">
<h4 id="effects-plots-for-models-with-compositional-predictors">Effects plots for models with compositional predictors<a class="anchor" aria-label="anchor" href="#effects-plots-for-models-with-compositional-predictors"></a>
</h4>
<p>Effects plots are great for visualising the average effect of a predictor in a model. However, if the predictors are compositional in nature, then standard effects plots are not very useful because of the sum to 1 constraint. The <code>visualise_effects</code> function creates effects plot for the compositional predictors in a model by ensuring that the sum to one constraint is respected as we increase or decrease the proportion of a particular variable.</p>
<p>In this example we specify few communities using the <code>data</code> argument and see the change in the predicted response as we increase the proportions of the species <code>p2</code> and <code>p3</code>in each community whilst keeping the ratio of the other species constant.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/visualise_effects.html">visualise_effects</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod_FG</span>, data <span class="op">=</span> <span class="va">my_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span>,</span>
<span>                  var_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p2"</span>, <span class="st">"p3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Finished data preparation.</span></span>
<span><span class="co">#&gt; ✔ Created plot.</span></span></code></pre></div>
<p><img src="reference/figures/README-effects-plot-1.png" alt="Output from visualise_effects() function" style="display: block; margin: auto;"></p>
<p>The grey lines show the effect (on the predicted response) of increasing the species of interest within a particular community while the solid black line shows the average effect of increasing the proportion of a species on the predicted response. It can be seen that for all communities increasing <code>p2</code> results in a decrease in the predicted response while increasing <code>p3</code> has a positive effect on the predicted response. Run <code><a href="reference/visualise_effects.html">?visualise_effects</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on creating and customising the plot.</p>
</div>
<div class="section level4">
<h4 id="simplex-path">Simplex path<a class="anchor" aria-label="anchor" href="#simplex-path"></a>
</h4>
<p>The concept used in <code>visualise_effects</code> can be extended to look at the change in the predicted response as we move in a straight line between any two points within the simplex space. The interpolation constant (shown on the X-axis) is a number between 0 and 1 identifying points along the straight line between the start and end points. We can even traverse a path comprising of multiple points within the simplex and see the change in the predicted response. In this example we show the change in the response as we move from the centroid mixture to the monoculture of each of the four species.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/simplex_path.html">simplex_path</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod_FG</span>, </span>
<span>             starts <span class="op">=</span> <span class="va">my_data</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span>,</span>
<span>             ends <span class="op">=</span> <span class="va">my_data</span><span class="op">[</span><span class="fl">12</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Finished data preparation.</span></span>
<span><span class="co">#&gt; ✔ Created plot.</span></span></code></pre></div>
<p><img src="reference/figures/README-simplex-path-1.png" alt="Output from simplex_path() function" style="display: block; margin: auto;"></p>
<p>We can see that moving from the centroid community to <code>p1</code>, <code>p2</code>, and <code>p4</code> decreases the predicted response, while moving towards a monoculture of <code>p3</code> increases the response. Run <code><a href="reference/simplex_path.html">?simplex_path</a></code> or see the associated <a href="https://htmlpreview.github.io/?https://github.com/rishvish/DImodelsVis/blob/main/pkgdown/assets/coming_soon.html" class="external-link">vignette</a> for more information on creating and customising the plot.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<div class="section level4">
<h4 id="useful-links">Useful links:<a class="anchor" aria-label="anchor" href="#useful-links"></a>
</h4>
<ul>
<li>DI models website: <a href="https://dimodels.com" class="external-link uri">https://dimodels.com</a>
</li>
<li>Package website: <a href="https://rishvish.github.io/DImodelsVis/" class="uri">https://rishvish.github.io/DImodelsVis/</a>
</li>
<li>Github repo: <a href="https://github.com/rishvish/DImodelsVis" class="external-link uri">https://github.com/rishvish/DImodelsVis</a>
</li>
<li>Report bugs: <a href="https://github.com/rishvish/DImodelsVis/issues" class="external-link uri">https://github.com/rishvish/DImodelsVis/issues</a>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="package-family">Package family:<a class="anchor" aria-label="anchor" href="#package-family"></a>
</h4>
<ul>
<li><a href="https://cran.r-project.org/package=DImodels" class="external-link">DImodels</a></li>
<li><a href="https://cran.r-project.org/package=DImodelsMulti" class="external-link">DImodelsMulti</a></li>
<li><a href="https://cran.r-project.org/package=PieGlyph" class="external-link">PieGlyph</a></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Connolly J, T Bell, T Bolger, C Brophy, T Carnus, JA Finn, L Kirwan, F Isbell, J Levine, A Lüscher, V Picasso, C Roscher, MT Sebastia, M Suter and A Weigelt (2013) An improved model to predict the effects of changing biodiversity levels on ecosystem function. Journal of Ecology, 101, 344-355.</li>
<li>Moral, R.A., Vishwakarma, R., Connolly, J., Byrne, L., Hurley, C., Finn, J.A. and Brophy, C., 2023. Going beyond richness: Modelling the BEF relationship using species identity, evenness, richness and species interactions via the DImodels R package. Methods in Ecology and Evolution, 14(9), pp.2250-2258</li>
<li>Kirwan L., Connolly J., Finn J.A., Brophy C., Lüscher A., Nyfeler D. and Sebastia M.T. 2009. Diversity-interaction modelling - estimating contributions of species identities and interactions to ecosystem function. Ecology, 90, 2032-2038.</li>
<li>Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, A., Carnus, T., Collins, R.P., Čop, J., Delgado, I. and De Vliegher, A., 2014. The Agrodiversity Experiment: three years of data from a multisite study in intensively managed grasslands.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=DImodelsVis" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing DImodelsVis</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Rishabh Vishwakarma <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4847-3494" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Caroline Brophy <br><small class="roles"> Author </small>   </li>
<li>Laura Byrne <br><small class="roles"> Author </small>   </li>
<li>Catherine Hurley <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=DImodelsVis" class="external-link"><img src="https://www.r-pkg.org/badges/version/DImodelsVis" alt="CRAN status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/rishvish/DImodelsVis/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/rishvish/DImodelsVis/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/rishvish/DImodelsVis" class="external-link"><img src="https://codecov.io/gh/rishvish/DImodelsVis/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rishabh Vishwakarma, Caroline Brophy, Laura Byrne, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
