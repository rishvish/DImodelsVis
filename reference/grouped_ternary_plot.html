<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Conditional ternary diagrams at functional group level — grouped_ternary_plot • DImodelsVis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conditional ternary diagrams at functional group level — grouped_ternary_plot"><meta name="description" content="The helper function for plotting grouped ternary diagrams. The output of
the `grouped_ternary_data` with the compositional variables
combined into groups should be passed here to be visualised on a 2-d ternary diagram.
These are very useful when we have multiple compositional variables that can
be grouped together by some hierarchical grouping structure. For example, grouping
species in a ecosystem based on the functions they perform, or grouping
political parties based on their national alliances."><meta property="og:description" content="The helper function for plotting grouped ternary diagrams. The output of
the `grouped_ternary_data` with the compositional variables
combined into groups should be passed here to be visualised on a 2-d ternary diagram.
These are very useful when we have multiple compositional variables that can
be grouped together by some hierarchical grouping structure. For example, grouping
species in a ecosystem based on the functions they perform, or grouping
political parties based on their national alliances."><meta property="og:image" content="https://rishvish.github.io/DImodelsVis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DImodelsVis-with-complex-models.html">Using DImodelsVis with regression models not fit using the DImodels package</a></li>
    <li><a class="dropdown-item" href="../articles/DImodelsVis-with-DImodelsMulti-models.html">Using DImodelsVis with regression models fit using the `DImodelsMulti` R package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Conditional ternary diagrams at functional group level</h1>

      <div class="d-none name"><code>grouped_ternary_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The helper function for plotting grouped ternary diagrams. The output of
the `<code><a href="grouped_ternary_data.html">grouped_ternary_data</a></code>` with the compositional variables
combined into groups should be passed here to be visualised on a 2-d ternary diagram.
These are very useful when we have multiple compositional variables that can
be grouped together by some hierarchical grouping structure. For example, grouping
species in a ecosystem based on the functions they perform, or grouping
political parties based on their national alliances.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">grouped_ternary_plot</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  col_var <span class="op">=</span> <span class="st">".Pred"</span>,</span>
<span>  nlevels <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower_lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper_lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tern_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  contour_text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_axis_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_axis_guides <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  axis_label_size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  vertex_label_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data-frame which is the output of the
`<a href="conditional_ternary_data.html">conditional_ternary_data</a>` function.</p></dd>


<dt id="arg-col-var">col_var<a class="anchor" aria-label="anchor" href="#arg-col-var"></a></dt>
<dd><p>The column name containing the variable to be used for
colouring the contours or points. The default is ".Pred".</p></dd>


<dt id="arg-nlevels">nlevels<a class="anchor" aria-label="anchor" href="#arg-nlevels"></a></dt>
<dd><p>The number of levels to show on the contour map.</p></dd>


<dt id="arg-colours">colours<a class="anchor" aria-label="anchor" href="#arg-colours"></a></dt>
<dd><p>A character vector or function specifying the colours for the
contour map or points. The number of colours should be same as
`nlevels` if (`show = "contours"`). <br>
The default colours scheme is the
<code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors()</a></code> for
continuous variables and an extended version of the Okabe-Ito
colour scale for categorical variables.</p></dd>


<dt id="arg-lower-lim">lower_lim<a class="anchor" aria-label="anchor" href="#arg-lower-lim"></a></dt>
<dd><p>A number to set a custom lower limit for the contour
(if `show = "contours"`). The default is minimum of the prediction.</p></dd>


<dt id="arg-upper-lim">upper_lim<a class="anchor" aria-label="anchor" href="#arg-upper-lim"></a></dt>
<dd><p>A number to set a custom upper limit for the contour
(if `show = "contours"`). The default is maximum of the prediction.</p></dd>


<dt id="arg-tern-labels">tern_labels<a class="anchor" aria-label="anchor" href="#arg-tern-labels"></a></dt>
<dd><p>A character vector containing the labels of the vertices
of the ternary. The default is the column names of the
first three columns of the data, with the first column
corresponding to the top vertex, second column corresponding
to the left vertex and the third column corresponding to
the right vertex of the ternary.</p></dd>


<dt id="arg-contour-text">contour_text<a class="anchor" aria-label="anchor" href="#arg-contour-text"></a></dt>
<dd><p>A boolean value indicating whether to include labels on
the contour lines showing their values
(if `show = "contours"`). The default is <code>FALSE</code>.</p></dd>


<dt id="arg-show-axis-labels">show_axis_labels<a class="anchor" aria-label="anchor" href="#arg-show-axis-labels"></a></dt>
<dd><p>A boolean value indicating whether to show axis
labels along the edges of the ternary. The default
is <code>TRUE</code>.</p></dd>


<dt id="arg-show-axis-guides">show_axis_guides<a class="anchor" aria-label="anchor" href="#arg-show-axis-guides"></a></dt>
<dd><p>A boolean value indicating whether to show axis
guides within the interior of the ternary. The
default is <code>FALSE</code>.</p></dd>


<dt id="arg-axis-label-size">axis_label_size<a class="anchor" aria-label="anchor" href="#arg-axis-label-size"></a></dt>
<dd><p>A numeric value to adjust the size of the axis labels
in the ternary plot. The default size is 4.</p></dd>


<dt id="arg-vertex-label-size">vertex_label_size<a class="anchor" aria-label="anchor" href="#arg-vertex-label-size"></a></dt>
<dd><p>A numeric value to adjust the size of the vertex
labels in the ternary plot. The default size is 5.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>Number of rows in which to arrange the final plot
(when `add_var` is specified).</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Number of columns in which to arrange the final plot
(when `add_var` is specified).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggmultiplot (ggplot if single plot is returned) class object or data-frame (if `plot = FALSE`)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DImodels</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="va">p5</span> <span class="op">+</span> <span class="va">p6</span> <span class="op">+</span> <span class="va">p7</span> <span class="op">+</span> <span class="va">p8</span> <span class="op">+</span> <span class="va">p9</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="va">sim3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create data</span></span></span>
<span class="r-in"><span><span class="co">## We have nine (p1 to p9) variables here and using conditional_ternary</span></span></span>
<span class="r-in"><span><span class="co">## to visualise the simplex space won't be very helpful as there are too</span></span></span>
<span class="r-in"><span><span class="co">## variables to condition on</span></span></span>
<span class="r-in"><span><span class="co">## Instead we group the nine-variables into three groups called "G", "L" and "H"</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="grouped_ternary_data.html">grouped_ternary_data</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                                  prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"L"</span>,<span class="st">"L"</span>,<span class="st">"H"</span>,<span class="st">"H"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  resolution <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The proportional split of species in the groups was not specified in `values`,</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> assuming an equal split for species in each group.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-in"><span><span class="fu">grouped_ternary_plot</span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created plot.</span>
<span class="r-plt img"><img src="grouped_ternary_plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## By default the variables within a group take up an equal share of the</span></span></span>
<span class="r-in"><span><span class="co">## group proportion. So for example, each point along the above ternary</span></span></span>
<span class="r-in"><span><span class="co">## would have a 50:50 split of the variables in the group "L" or "H", thus</span></span></span>
<span class="r-in"><span><span class="co">## the vertex where "L" is 1, would mean that p6 and p7 are 0.5 each,</span></span></span>
<span class="r-in"><span><span class="co">## similarly, the vertex "H" is made up of 0.5 of p8 and p9 while the "G"</span></span></span>
<span class="r-in"><span><span class="co">## vertex is comprised of 0.2 of each of p1, p2, p3, p4, and p5. The concepts</span></span></span>
<span class="r-in"><span><span class="co">## also extend to points along the edges and interior of the ternary.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Change the proportional split of species within an FG by using `values`</span></span></span>
<span class="r-in"><span><span class="co">## `values` takes a numeric vector where the position of each element</span></span></span>
<span class="r-in"><span><span class="co">## describes the proportion of the corresponding species within the</span></span></span>
<span class="r-in"><span><span class="co">## corresponding FG</span></span></span>
<span class="r-in"><span><span class="co">## For examples this vector describes, 2-% each of p1, p2, p3, p4 and p5,</span></span></span>
<span class="r-in"><span><span class="co">## in G, 0% and 100% of p6 and p7, respectively in G2 and 30% and 70% of</span></span></span>
<span class="r-in"><span><span class="co">## p8 and p9, respectively in G3.</span></span></span>
<span class="r-in"><span><span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>          <span class="fl">0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>          <span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="grouped_ternary_data.html">grouped_ternary_data</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"L"</span>,<span class="st">"L"</span>,<span class="st">"H"</span>,<span class="st">"H"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  values <span class="op">=</span> <span class="va">vals</span>,</span></span>
<span class="r-in"><span>                                  resolution <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                  model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-in"><span><span class="co">## Change number of contours and colour scheme</span></span></span>
<span class="r-in"><span><span class="fu">grouped_ternary_plot</span><span class="op">(</span><span class="va">plot_data</span>,</span></span>
<span class="r-in"><span>                     nlevels <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                     colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created plot.</span>
<span class="r-plt img"><img src="grouped_ternary_plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Can also add any additional experimental structures</span></span></span>
<span class="r-in"><span><span class="co">## Notice .add_str_ID in the data</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="grouped_ternary_data.html">grouped_ternary_data</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"G"</span>,<span class="st">"L"</span>,<span class="st">"L"</span>,<span class="st">"H"</span>,<span class="st">"H"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"treatment"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"50"</span>, <span class="st">"150"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                  values <span class="op">=</span> <span class="va">vals</span>,</span></span>
<span class="r-in"><span>                                  model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                                  resolution <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-in"><span><span class="fu">grouped_ternary_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created all plots.</span>
<span class="r-plt img"><img src="grouped_ternary_plot-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rishabh Vishwakarma, Caroline Brophy, Laura Byrne, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

