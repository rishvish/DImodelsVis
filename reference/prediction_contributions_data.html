<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model term contributions to predicted response — prediction_contributions_data • DImodelsVis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model term contributions to predicted response — prediction_contributions_data"><meta name="description" content="The helper function for preparing the data to split the predicted response
from a regression model into contributions (predictor coefficient * predictor value)
by the terms in the model. The output of this function can be passed to the
`prediction_contributions_plot` function to visualise the results."><meta property="og:description" content="The helper function for preparing the data to split the predicted response
from a regression model into contributions (predictor coefficient * predictor value)
by the terms in the model. The output of this function can be passed to the
`prediction_contributions_plot` function to visualise the results."><meta property="og:image" content="https://rishvish.github.io/DImodelsVis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model term contributions to predicted response</h1>

      <div class="d-none name"><code>prediction_contributions_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The helper function for preparing the data to split the predicted response
from a regression model into contributions (predictor coefficient * predictor value)
by the terms in the model. The output of this function can be passed to the
`<a href="prediction_contributions_plot.html">prediction_contributions_plot</a>` function to visualise the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prediction_contributions_data</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coefficients <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coeff_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vcov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"confidence"</span>, <span class="st">"prediction"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  bar_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A user-defined data-frame containing values for compositional variables
along with any additional variables that the user wishes to predict for.
If left blank, a selection of observations (2 from each level of
richness) from the original data used to fit the model would be selected.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A Diversity Interactions model object fit by using the
<code><a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI()</a></code> function from the
<code><a href="https://rdrr.io/pkg/DImodels/man/DImodels-package.html" class="external-link">DImodels</a></code> package.</p></dd>


<dt id="arg-coefficients">coefficients<a class="anchor" aria-label="anchor" href="#arg-coefficients"></a></dt>
<dd><p>If a regression model is not available (or can't be fit in R),
the regression coefficients from a model fit in some other
language can be used to calculate predictions. However, the
user would have to ensure there's an appropriate one-to-one
positional mapping between the data columns and the
coefficient values. Further, they would also have to provide
a variance-covariance matrix of the coefficients in the `vcov`
parameter if they want the associated CI for the prediction or
it would not be possible to calculate confidence/prediction
intervals using this method.</p></dd>


<dt id="arg-coeff-cols">coeff_cols<a class="anchor" aria-label="anchor" href="#arg-coeff-cols"></a></dt>
<dd><p>If `coefficients` are specified and a one-to-one positional
mapping between the data-columns and coefficient vector is
not present. A character string or numeric index can be specified
here to reorder the data columns and match the corresponding
coefficient value to the respective data column. See the
"Use model coefficients for prediction" section in examples.</p></dd>


<dt id="arg-vcov">vcov<a class="anchor" aria-label="anchor" href="#arg-vcov"></a></dt>
<dd><p>If regression coefficients are specified, then the variance-covariance
matrix of the coefficients can be specified here to calculate the
associated confidence interval around each prediction. Failure to do
so would result in no confidence intervals being returned. Ensure
`coefficients` and `vcov` have the same positional mapping with the data.</p></dd>


<dt id="arg-add-var">add_var<a class="anchor" aria-label="anchor" href="#arg-add-var"></a></dt>
<dd><p>A list specifying values for additional predictor variables
in the model independent of the compositional predictor variables.
This could be useful for comparing the predictions across
different values for a non-compositional variable.
If specified as a list, it will be expanded to show a plot
for each unique combination of values specified, while if specified
as a data-frame, one plot would be generated for each row in the
data and they will be arranged in a grid according to the
value specified in `nrow` and `ncol`.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>A list specifying groupings to arrange coefficients into.
The coefficients within a group will be added together and
shown as a single component on the respective bars in the plot.
This could be useful for grouping multiple similar terms
into a single term for better visibility.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>The confidence level for calculating confidence or
prediction intervals.</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>Type of interval to calculate:</p><dl><dt>"none"</dt>
<dd><p>No interval to be calculated.</p></dd>

  <dt>"confidence" (default)</dt>
<dd><p>Calculate a confidence interval.</p></dd>

  <dt>"prediction"</dt>
<dd><p>Calculate a prediction interval.</p></dd>


</dl></dd>


<dt id="arg-bar-labs">bar_labs<a class="anchor" aria-label="anchor" href="#arg-bar-labs"></a></dt>
<dd><p>The labels to be shown for each bar in the plot. The user
has three options:
   - By default, the row-names in the data would be used as
     labels for the bars.
   - A character string or numeric index indicating an ID
     column in data.
   - A character vector of same length as the number of rows
     in the data, which manually specifies the names for each bar.
If none of the three options are available, the function would
assign a unique ID for each bar.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data-frame with the following columns. Any additional columns which
weren't used when fitting the model would also be present.</p><dl><dt>.Community</dt>
<dd><p>An identifier column to discern each
                     observation in the data. These are the labels which
                     will be displayed for the bars in the plot.</p></dd>

   <dt>.add_str_ID</dt>
<dd><p>An identifier column for grouping the cartesian product
                      of all additional columns specified in `add_var`
                      parameter (if `add_var` is specified).</p></dd>

   <dt>.Pred</dt>
<dd><p>The predicted repsonse for each observation.</p></dd>

   <dt>.Lower</dt>
<dd><p>The lower limit of the prediction interval for
                 each observation.</p></dd>

   <dt>.Upper</dt>
<dd><p>The lower limit of the prediction interval for
                 each observation.</p></dd>

   <dt>.Contributions</dt>
<dd><p>An identifier describing the name of the
                         coefficient contributing to the response.</p></dd>

   <dt>.Value</dt>
<dd><p>The contributed value of the respective coefficient/group
                 to the total prediction.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com/" class="external-link">DImodels</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, data <span class="op">=</span> <span class="va">sim2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                              model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 40 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .x_labs .Community  community block response .Pred .Lower .Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 30 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: .Contributions &lt;chr&gt;, .Value &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Specific coefficients can also be grouped together</span></span></span>
<span class="r-in"><span><span class="co">## Either by their indices in the model coefficient vector</span></span></span>
<span class="r-in"><span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                              model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                              groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Interactions"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .x_labs .Community  community block response .Pred .Lower .Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> 9       Community 3         3 1         17.9  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> 9       Community 3         3 1         17.9  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> 9       Community 3         3 1         17.9  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> 9       Community 3         3 1         17.9  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> 9       Community 3         3 1         17.9  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> 11      Community 4         3 3         17.6  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> 11      Community 4         3 3         17.6  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> 11      Community 4         3 3         17.6  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> 11      Community 4         3 3         17.6  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> 11      Community 4         3 3         17.6  16.6   15.8   17.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: .Contributions &lt;chr&gt;, .Value &lt;dbl&gt;</span></span>
<span class="r-in"><span><span class="co">## Or by specifying the coefficient names as character strings</span></span></span>
<span class="r-in"><span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                              model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                              groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"p1_Ints"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1:p2"</span>,</span></span>
<span class="r-in"><span>                                                          <span class="st">"p1:p3"</span>,</span></span>
<span class="r-in"><span>                                                          <span class="st">"p1:p4"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 32 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .x_labs .Community  community block response .Pred .Lower .Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 1       Community 1         1 1         20.2  18.4   17.6   19.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 5       Community 2         2 1         17.2  17.5   16.7   18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 22 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: .Contributions &lt;chr&gt;, .Value &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Additional variables can also be added to the data by either specifying</span></span></span>
<span class="r-in"><span><span class="co">## them directly in the `data` or by using the `add_var` argument</span></span></span>
<span class="r-in"><span><span class="co">## Refit model</span></span></span>
<span class="r-in"><span><span class="va">sim2</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">$</span><span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod</span>, <span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">sim2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## This model has block so we can either specify block in the data</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span> <span class="op">&lt;-</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    block  p1  p2  p3  p4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 0.7 0.1 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1 0.1 0.7 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1 0.1 0.1 0.7 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     3 0.1 0.1 0.7 0.1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset_data</span>,</span></span>
<span class="r-in"><span>                                   model <span class="op">=</span> <span class="va">new_mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .x_labs .Community  .Pred .Lower .Upper .Contributions .Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1       Community 1  19.1   18.2   20.1 p1              8.29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1       Community 1  19.1   18.2   20.1 p2              1.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1       Community 1  19.1   18.2   20.1 p3              1.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1       Community 1  19.1   18.2   20.1 p4              0.967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1       Community 1  19.1   18.2   20.1 block          -<span style="color: #BB0000;">0.456</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1       Community 1  19.1   18.2   20.1 p1:p2           2.37 </span>
<span class="r-in"><span><span class="co">## Or we could add the variable using `add_var`</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span> <span class="op">&lt;-</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     p1  p2  p3  p4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.7 0.1 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.1 0.7 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.1 0.1 0.7 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.1 0.1 0.7 0.1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset_data</span>,</span></span>
<span class="r-in"><span>                                   model <span class="op">=</span> <span class="va">new_mod</span>,</span></span>
<span class="r-in"><span>                                   add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .x_labs .Community  .add_str_ID .Pred .Lower .Upper .Contributions .Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1       Community 1 block: 1     19.1   18.2   20.1 p1              8.29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1       Community 1 block: 1     19.1   18.2   20.1 p2              1.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1       Community 1 block: 1     19.1   18.2   20.1 p3              1.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1       Community 1 block: 1     19.1   18.2   20.1 p4              0.967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1       Community 1 block: 1     19.1   18.2   20.1 block          -<span style="color: #BB0000;">0.456</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1       Community 1 block: 1     19.1   18.2   20.1 p1:p2           2.37 </span>
<span class="r-in"><span><span class="co">## The benefit of specifying the variable this way is we have an ID</span></span></span>
<span class="r-in"><span><span class="co">## columns now called `.add_str_ID` which would be used to create a</span></span></span>
<span class="r-in"><span><span class="co">## separate plot for each value of the additional variable</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model coefficients can also be used, but then user would have</span></span></span>
<span class="r-in"><span><span class="co">## to specify the data with all columns corresponding to each coefficient</span></span></span>
<span class="r-in"><span><span class="va">coef_data</span> <span class="op">&lt;-</span> <span class="va">sim2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`p1:p2` <span class="op">=</span> <span class="va">p1</span><span class="op">*</span><span class="va">p2</span>, `p1:p3` <span class="op">=</span> <span class="va">p1</span><span class="op">*</span><span class="va">p2</span>, `p1:p4` <span class="op">=</span> <span class="va">p1</span><span class="op">*</span><span class="va">p4</span>,</span></span>
<span class="r-in"><span>                      `p2:p3` <span class="op">=</span> <span class="va">p2</span><span class="op">*</span><span class="va">p3</span>, `p2:p4` <span class="op">=</span> <span class="va">p2</span><span class="op">*</span><span class="va">p4</span>, `p3:p4` <span class="op">=</span> <span class="va">p3</span><span class="op">*</span><span class="va">p4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>,</span></span>
<span class="r-in"><span>                      <span class="va">`p1:p2`</span>, <span class="va">`p1:p3`</span>, <span class="va">`p1:p4`</span>,</span></span>
<span class="r-in"><span>                      <span class="va">`p2:p3`</span>, <span class="va">`p2:p4`</span>, <span class="va">`p3:p4`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">coef_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     p1  p2  p3  p4 p1:p2 p1:p3 p1:p4 p2:p3 p2:p4 p3:p4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.7 0.1 0.1 0.1  0.07  0.07  0.07  0.01  0.01  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.1 0.7 0.1 0.1  0.07  0.07  0.01  0.07  0.07  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.1 0.1 0.7 0.1  0.01  0.01  0.01  0.07  0.01  0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.1 0.1 0.7 0.1  0.01  0.01  0.01  0.07  0.01  0.07</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        p1        p2        p3        p4     p1:p2     p1:p3     p1:p4     p2:p3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.699426 10.228917  8.939289  8.532857 33.894874 37.552444 32.720996 26.739691 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     p2:p4     p3:p4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33.188799 27.771368 </span>
<span class="r-in"><span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coef_data</span>,</span></span>
<span class="r-in"><span>                              coefficients <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span>,</span></span>
<span class="r-in"><span>                              interval <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 40 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .x_labs .Community  .Pred .Contributions .Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 1       Community 1  18.4 p1              7.49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 1       Community 1  18.4 p2              1.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 1       Community 1  18.4 p3              0.894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 1       Community 1  18.4 p4              0.853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 1       Community 1  18.4 p1:p2           2.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 1       Community 1  18.4 p1:p3           2.63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 1       Community 1  18.4 p1:p4           2.29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 1       Community 1  18.4 p2:p3           0.267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 1       Community 1  18.4 p2:p4           0.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 1       Community 1  18.4 p3:p4           0.278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 30 more rows</span></span>
<span class="r-in"><span><span class="co">## To get uncertainity using coefficients vcov matrix would have to specified</span></span></span>
<span class="r-in"><span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coef_data</span>,</span></span>
<span class="r-in"><span>                              coefficients <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span>,</span></span>
<span class="r-in"><span>                              vcov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 40 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .x_labs .Community  .Pred .Lower .Upper .Contributions .Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 1       Community 1  18.4   17.6   19.3 p1              7.49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 1       Community 1  18.4   17.6   19.3 p2              1.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 1       Community 1  18.4   17.6   19.3 p3              0.894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 1       Community 1  18.4   17.6   19.3 p4              0.853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 1       Community 1  18.4   17.6   19.3 p1:p2           2.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 1       Community 1  18.4   17.6   19.3 p1:p3           2.63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 1       Community 1  18.4   17.6   19.3 p1:p4           2.29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 1       Community 1  18.4   17.6   19.3 p2:p3           0.267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 1       Community 1  18.4   17.6   19.3 p2:p4           0.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 1       Community 1  18.4   17.6   19.3 p3:p4           0.278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 30 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Specifying `bar_labs`</span></span></span>
<span class="r-in"><span><span class="co">## Our data has four rows so we'd need four labels in bar_labs</span></span></span>
<span class="r-in"><span><span class="fu">prediction_contributions_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coef_data</span>,</span></span>
<span class="r-in"><span>                              coefficients <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span>,</span></span>
<span class="r-in"><span>                              vcov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              bar_labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1 Domm"</span>, <span class="st">"p2 Domm"</span>,</span></span>
<span class="r-in"><span>                                           <span class="st">"p3 Domm"</span>, <span class="st">"p4 Domm"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 40 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .x_labs .Community  .Pred .Lower .Upper .Contributions .Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> p1 Domm Community 1  18.4   17.6   19.3 p1              7.49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> p1 Domm Community 1  18.4   17.6   19.3 p2              1.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> p1 Domm Community 1  18.4   17.6   19.3 p3              0.894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> p1 Domm Community 1  18.4   17.6   19.3 p4              0.853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> p1 Domm Community 1  18.4   17.6   19.3 p1:p2           2.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> p1 Domm Community 1  18.4   17.6   19.3 p1:p3           2.63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> p1 Domm Community 1  18.4   17.6   19.3 p1:p4           2.29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> p1 Domm Community 1  18.4   17.6   19.3 p2:p3           0.267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> p1 Domm Community 1  18.4   17.6   19.3 p2:p4           0.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> p1 Domm Community 1  18.4   17.6   19.3 p3:p4           0.278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 30 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rishabh Vishwakarma, Caroline Brophy, Laura Byrne, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

