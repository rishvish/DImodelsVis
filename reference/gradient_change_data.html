<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate change in predicted response over diversity gradient — gradient_change_data • DImodelsVis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate change in predicted response over diversity gradient — gradient_change_data"><meta name="description" content='Helper function for creating the data to visualise a scatter-plot of the
response over a diversity gradient. The "richness" and "evenness"
diversity gradients are currently supported. The average (predicted) response
is calculated from all communities present at a given level of the
chosen diversity gradient in `data`. The output of this
function can be passed to the gradient_change_plot function
to visualise results.'><meta property="og:description" content='Helper function for creating the data to visualise a scatter-plot of the
response over a diversity gradient. The "richness" and "evenness"
diversity gradients are currently supported. The average (predicted) response
is calculated from all communities present at a given level of the
chosen diversity gradient in `data`. The output of this
function can be passed to the gradient_change_plot function
to visualise results.'><meta property="og:image" content="https://rishvish.github.io/DImodelsVis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DImodelsVis-with-complex-models.html">Using DImodelsVis with regression models not fit using the DImodels package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate change in predicted response over diversity gradient</h1>

      <div class="d-none name"><code>gradient_change_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Helper function for creating the data to visualise a scatter-plot of the
response over a diversity gradient. The "richness" and "evenness"
diversity gradients are currently supported. The average (predicted) response
is calculated from all communities present at a given level of the
chosen diversity gradient in `data`. The output of this
function can be passed to the <code><a href="gradient_change_plot.html">gradient_change_plot</a></code> function
to visualise results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gradient_change_data</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">prop</span>,</span>
<span>  add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  gradient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"evenness"</span><span class="op">)</span>,</span>
<span>  prediction <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data-frame consisting of variable proportions and
any other necessary variables to make predictions from
`model` or `coefficients`.</p></dd>


<dt id="arg-prop">prop<a class="anchor" aria-label="anchor" href="#arg-prop"></a></dt>
<dd><p>A vector identifying the column-names or indices of the
columns containing the variable proportions in `data`.</p></dd>


<dt id="arg-add-var">add_var<a class="anchor" aria-label="anchor" href="#arg-add-var"></a></dt>
<dd><p>A list specifying values for additional predictor variables
in the model independent of the compositional predictor variables.
This could be useful for comparing the predictions across
different values for a non-compositional variable.
If specified as a list, it will be expanded to show a plot
for each unique combination of values specified, while if specified
as a data-frame, one plot would be generated for each row in the
data and they will be arranged in a grid according to the
value specified in `nrow` and `ncol`.</p></dd>


<dt id="arg-gradient">gradient<a class="anchor" aria-label="anchor" href="#arg-gradient"></a></dt>
<dd><p>Diversity gradient to show on the X-axis, one of
"richness" or "evenness". Defaults to "richness". See
`Details` for more information.</p></dd>


<dt id="arg-prediction">prediction<a class="anchor" aria-label="anchor" href="#arg-prediction"></a></dt>
<dd><p>A logical value indicating whether to pass the final
data to the `add_prediction` function and append the
predictions to the data. Default value is TRUE, but
often it would be desirable to make additional changes
to the data before making any predictions, so the user
can set this to FALSE and manually call the `add_prediction`
function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="add_prediction.html">add_prediction</a></code></p><dl><dt><code>model</code></dt>
<dd><p>A regression model object which will be used to make predictions
for the observations in `data`. Will override `coefficients`
if specified.</p></dd>

    <dt><code>coefficients</code></dt>
<dd><p>If a regression model is not available (or can't be fit in R),
the regression coefficients from a model fit in some other
language can be used to calculate predictions. However, the
user would have to ensure there's an appropriate one-to-one
positional mapping between the data columns and the
coefficient values. Further, they would also have to provide
a variance-covariance matrix of the coefficients in the `vcov`
parameter if they want the associated CI for the prediction or
it would not be possible to calculate confidence/prediction
intervals using this method.</p></dd>

    <dt><code>vcov</code></dt>
<dd><p>If regression coefficients are specified, then the variance-covariance
matrix of the coefficients can be specified here to calculate the
associated confidence interval around each prediction. Failure to do
so would result in no confidence intervals being returned. Ensure
`coefficients` and `vcov` have the same positional mapping with the data.</p></dd>

    <dt><code>coeff_cols</code></dt>
<dd><p>If `coefficients` are specified and a one-to-one positional
mapping between the data-columns and coefficient vector is
not present. A character string or numeric index can be specified
here to reorder the data columns and match the corresponding
coefficient value to the respective data column. See the
"Use model coefficients for prediction" section in examples.</p></dd>

    <dt><code>conf.level</code></dt>
<dd><p>The confidence level for calculating confidence/prediction
intervals. Default is 0.95.</p></dd>

    <dt><code>interval</code></dt>
<dd><p>Type of interval to calculate:</p><dl><dt>"none" (default)</dt>
<dd><p>No interval to be calculated.</p></dd>

  <dt>"confidence"</dt>
<dd><p>Calculate a confidence interval.</p></dd>

  <dt>"prediction"</dt>
<dd><p>Calculate a prediction interval.</p></dd>


</dl></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The data-frame with the following columns appended at the end</p><dl><dt>.Richness</dt>
<dd><p>The richness (number of non-zero compositional variables)
                    within each observation.</p></dd>

   <dt>.Evenness</dt>
<dd><p>The evenness (metric quantifying the relative abundance
                    of each compositional variable) within each observation.</p></dd>

   <dt>.Gradient</dt>
<dd><p>An character string defining the diversity gradient used
                    for averaging the response.</p></dd>

   <dt>.add_str_ID</dt>
<dd><p>An identifier column for grouping the cartesian product
                      of all additional columns specified in `add_var`
                      parameter (if `add_var` is specified).</p></dd>

   <dt>.Pred</dt>
<dd><p>The predicted response for each obsvervation.</p></dd>

   <dt>.Lower</dt>
<dd><p>The lower limit of the prediction/confidence interval
                 for each observation.</p></dd>

   <dt>.Upper</dt>
<dd><p>The upper limit of the prediction/confidence interval
                 for each observation.</p></dd>

   <dt>.Avg</dt>
<dd><p>The averaged value of the predicted response for each unique
               value of the selected diversity gradient.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Currently two diversity gradients are supported</p><ul><li><p><strong>Richness</strong>: A metric describing the number of non-zero compositional
  variables in an observation.</p></li>
<li><p><strong>Evenness</strong>: A metric quantifying the relative abundances of all
  compositional variables in an observation. Defined as
  $$(2s/(s-1)) \sum_{i, j = 1; i &lt; j}^{s}{p_i * p_j}$$ where \(s\) is the
  total number of compositional variables and \(p_i\) and \(p_j\) are the
  proportions of the variables \(i\) and \(j\).
  See Kirwan et al., 2007 &lt;<a href="https://doi.org/10.1890/08-1684.1" class="external-link">doi:10.1890/08-1684.1</a>
&gt; and Kirwan et al., 2009
  &lt;<a href="https://doi.org/10.1890/08-1684.1" class="external-link">doi:10.1890/08-1684.1</a>
&gt; for more
  information.</p></li>
</ul><p>Here's a small example of how these metrics are calculated for a few
observations. Suppose we have four compositional variables (i.e. \(s = 4\))
and have the following three observations</p><ul><li><p>A = (0.5, 0.5, 0, 0)</p></li>
<li><p>B = (0.25, 0.25, 0.25, 0.25)</p></li>
<li><p>C = (1, 0, 0, 0)</p></li>
</ul><p>The richness values for these three observations would be as follows</p><ul><li><p>A = 2 (Since two of the four compositional variables were non-zero)</p></li>
<li><p>B = 4 (Since all four compositional variables were non-zero)</p></li>
<li><p>C = 1 (Since one of the four compositional variables were non-zero)</p></li>
</ul><p>The evenness values would be calculated as follows</p><ul><li><p>A = \(2*4/(4-1)*(0.5*0.5+0.5*0+0.5*0+0.5*0+0.5*0+0*0) = 0.67\)</p></li>
<li><p>B = \(2*4/(4-1)*(0.25*0.25+0.25*0.25+0..25*0.25+0.25*0.25+0.25*0.25+0.25*0) = 1\)</p></li>
<li><p>C = \(2*4/(4-1)*(1*0+1*0+1*0+0*0+0*0+0*0) = 0\)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DImodels</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, data <span class="op">=</span> <span class="va">sim2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create data</span></span></span>
<span class="r-in"><span><span class="co">## By default response would be averaged on the basis of richness</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">gradient_change_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim2</span>,</span></span>
<span class="r-in"><span>                          prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   community block    p1    p2    p3    p4 response .Richness .Evenness .Gradient</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>         1 1       0.7   0.1   0.1   0.1     20.2         4      0.64 .Richness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>         1 2       0.7   0.1   0.1   0.1     20.1         4      0.64 .Richness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>         1 3       0.7   0.1   0.1   0.1     20.9         4      0.64 .Richness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>         1 4       0.7   0.1   0.1   0.1     17.0         4      0.64 .Richness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>         2 1       0.1   0.7   0.1   0.1     17.2         4      0.64 .Richness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>         2 2       0.1   0.7   0.1   0.1     19.9         4      0.64 .Richness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: .Pred &lt;dbl&gt;, .Avg &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Average response with respect to evenness</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">gradient_change_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim2</span>,</span></span>
<span class="r-in"><span>                          prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                          gradient <span class="op">=</span> <span class="st">"evenness"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   community block    p1    p2    p3    p4 response .Richness .Evenness .Gradient</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>         1 1       0.7   0.1   0.1   0.1     20.2         4      0.64 .Evenness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>         1 2       0.7   0.1   0.1   0.1     20.1         4      0.64 .Evenness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>         1 3       0.7   0.1   0.1   0.1     20.9         4      0.64 .Evenness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>         1 4       0.7   0.1   0.1   0.1     17.0         4      0.64 .Evenness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>         2 1       0.1   0.7   0.1   0.1     17.2         4      0.64 .Evenness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>         2 2       0.1   0.7   0.1   0.1     19.9         4      0.64 .Evenness</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: .Pred &lt;dbl&gt;, .Avg &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Additional variables can also be added to the data by either specifying</span></span></span>
<span class="r-in"><span><span class="co">## them directly in the `data` or by using the `add_var` argument</span></span></span>
<span class="r-in"><span><span class="co">## Refit model</span></span></span>
<span class="r-in"><span><span class="va">sim2</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">$</span><span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod</span>, <span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">sim2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## This model has block so we can either specify block in the data</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span> <span class="op">&lt;-</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    block  p1  p2  p3  p4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 0.7 0.1 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1 0.1 0.7 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1 0.1 0.1 0.7 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     3 0.1 0.1 0.7 0.1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">gradient_change_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset_data</span>,</span></span>
<span class="r-in"><span>                          prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                          gradient <span class="op">=</span> <span class="st">"evenness"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   block    p1    p2    p3    p4 .Richness .Evenness .Gradient .Pred  .Avg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1   0.7   0.1   0.1   0.1         4      0.64 .Evenness  18.4  17.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1   0.1   0.7   0.1   0.1         4      0.64 .Evenness  17.5  17.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1   0.1   0.1   0.7   0.1         4      0.64 .Evenness  16.6  17.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     3   0.1   0.1   0.7   0.1         4      0.64 .Evenness  16.6  17.3</span>
<span class="r-in"><span><span class="co">## Or we could add the variable using `add_var`</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span> <span class="op">&lt;-</span> <span class="va">sim2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">subset_data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     p1  p2  p3  p4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.7 0.1 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.1 0.7 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.1 0.1 0.7 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.1 0.1 0.7 0.1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">gradient_change_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset_data</span>,</span></span>
<span class="r-in"><span>                          prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          model <span class="op">=</span> <span class="va">new_mod</span>,</span></span>
<span class="r-in"><span>                          gradient <span class="op">=</span> <span class="st">"evenness"</span>,</span></span>
<span class="r-in"><span>                          add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      p1    p2    p3    p4 block .add_str_ID .Richness .Evenness .Gradient .Pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   0.7   0.1   0.1   0.1     1 block: 1            4      0.64 .Evenness  19.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>   0.1   0.7   0.1   0.1     1 block: 1            4      0.64 .Evenness  18.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>   0.1   0.1   0.7   0.1     1 block: 1            4      0.64 .Evenness  17.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>   0.1   0.1   0.7   0.1     1 block: 1            4      0.64 .Evenness  17.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>   0.7   0.1   0.1   0.1     2 block: 2            4      0.64 .Evenness  18.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>   0.1   0.7   0.1   0.1     2 block: 2            4      0.64 .Evenness  17.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: .Avg &lt;dbl&gt;</span></span>
<span class="r-in"><span><span class="co">## The benefit of specifying the variable this way is we have an ID</span></span></span>
<span class="r-in"><span><span class="co">## columns now called `.add_str_ID` which could be used to create a</span></span></span>
<span class="r-in"><span><span class="co">## separate plot for each value of the additional variable</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model coefficients can also be used, but then user would have</span></span></span>
<span class="r-in"><span><span class="co">## to specify the data with all columns corresponding to each coefficient</span></span></span>
<span class="r-in"><span><span class="va">coef_data</span> <span class="op">&lt;-</span> <span class="va">sim2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`p1:p2` <span class="op">=</span> <span class="va">p1</span><span class="op">*</span><span class="va">p2</span>, `p1:p3` <span class="op">=</span> <span class="va">p1</span><span class="op">*</span><span class="va">p2</span>, `p1:p4` <span class="op">=</span> <span class="va">p1</span><span class="op">*</span><span class="va">p4</span>,</span></span>
<span class="r-in"><span>                      `p2:p3` <span class="op">=</span> <span class="va">p2</span><span class="op">*</span><span class="va">p3</span>, `p2:p4` <span class="op">=</span> <span class="va">p2</span><span class="op">*</span><span class="va">p4</span>, `p3:p4` <span class="op">=</span> <span class="va">p3</span><span class="op">*</span><span class="va">p4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>,</span></span>
<span class="r-in"><span>                      <span class="va">`p1:p2`</span>, <span class="va">`p1:p3`</span>, <span class="va">`p1:p4`</span>,</span></span>
<span class="r-in"><span>                      <span class="va">`p2:p3`</span>, <span class="va">`p2:p4`</span>, <span class="va">`p3:p4`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">coef_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     p1  p2  p3  p4 p1:p2 p1:p3 p1:p4 p2:p3 p2:p4 p3:p4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.7 0.1 0.1 0.1  0.07  0.07  0.07  0.01  0.01  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.1 0.7 0.1 0.1  0.07  0.07  0.01  0.07  0.07  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.1 0.1 0.7 0.1  0.01  0.01  0.01  0.07  0.01  0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.1 0.1 0.7 0.1  0.01  0.01  0.01  0.07  0.01  0.07</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        p1        p2        p3        p4     p1:p2     p1:p3     p1:p4     p2:p3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.699426 10.228917  8.939289  8.532857 33.894874 37.552444 32.720996 26.739691 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     p2:p4     p3:p4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33.188799 27.771368 </span>
<span class="r-in"><span><span class="fu">gradient_change_data</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coef_data</span>,</span></span>
<span class="r-in"><span>                     prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     gradient <span class="op">=</span> <span class="st">"evenness"</span>,</span></span>
<span class="r-in"><span>                     coefficients <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span>,</span></span>
<span class="r-in"><span>                     interval <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      p1    p2    p3    p4 `p1:p2` `p1:p3` `p1:p4` `p2:p3` `p2:p4` `p3:p4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   0.7   0.1   0.1   0.1    0.07    0.07    0.07    0.01    0.01    0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>   0.1   0.7   0.1   0.1    0.07    0.07    0.01    0.07    0.07    0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>   0.1   0.1   0.7   0.1    0.01    0.01    0.01    0.07    0.01    0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>   0.1   0.1   0.7   0.1    0.01    0.01    0.01    0.07    0.01    0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 5 more variables: .Richness &lt;dbl&gt;, .Evenness &lt;dbl&gt;, .Gradient &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   .Pred &lt;dbl&gt;, .Avg &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rishabh Vishwakarma, Caroline Brophy, Laura Byrne, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

