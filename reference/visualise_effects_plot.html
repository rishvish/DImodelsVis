<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Effects plot for compositional data — visualise_effects_plot • DImodelsVis</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Effects plot for compositional data — visualise_effects_plot"><meta name="description" content="The plotting function to create plots showing the effect of increasing or
decreasing the proportion of a variable from a set of compositional variables.
The output of the `visualise_effects_data` function (with any
desired modifications) should be passed here. The generated plot will show a
curve for each observation (whenever possible) in the data.
`Pie-glyphs` are
used to highlight the compositions of the specified communities and the ending
community after the variable of interest either completes dominates the community
(when looking at the effect of increase) or completely vanishes from the community
(when looking at the effect of decrease) or both."><meta property="og:description" content="The plotting function to create plots showing the effect of increasing or
decreasing the proportion of a variable from a set of compositional variables.
The output of the `visualise_effects_data` function (with any
desired modifications) should be passed here. The generated plot will show a
curve for each observation (whenever possible) in the data.
`Pie-glyphs` are
used to highlight the compositions of the specified communities and the ending
community after the variable of interest either completes dominates the community
(when looking at the effect of increase) or completely vanishes from the community
(when looking at the effect of decrease) or both."><meta property="og:image" content="https://rishvish.github.io/DImodelsVis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Effects plot for compositional data</h1>

      <div class="d-none name"><code>visualise_effects_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The plotting function to create plots showing the effect of increasing or
decreasing the proportion of a variable from a set of compositional variables.
The output of the `<code><a href="visualise_effects_data.html">visualise_effects_data</a></code>` function (with any
desired modifications) should be passed here. The generated plot will show a
curve for each observation (whenever possible) in the data.
`<code><a href="https://rishvish.github.io/PieGlyph/reference/PieGlyph-package.html" class="external-link">Pie-glyphs</a></code>` are
used to highlight the compositions of the specified communities and the ending
community after the variable of interest either completes dominates the community
(when looking at the effect of increase) or completely vanishes from the community
(when looking at the effect of decrease) or both.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">visualise_effects_plot</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">prop</span>,</span>
<span>  pie_colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pie_radius <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  average <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame created using the <code><a href="visualise_effects_data.html">visualise_effects_data</a></code> function.</p></dd>


<dt id="arg-prop">prop<a class="anchor" aria-label="anchor" href="#arg-prop"></a></dt>
<dd><p>A vector of column names or indices identifying the columns containing the
compositional variables in the data. Will be inferred from the data if
it is created using the `<code><a href="visualise_effects_data.html">visualise_effects_data</a></code>`
function, but the user also has the flexibility of manually
specifying the values.</p></dd>


<dt id="arg-pie-colours">pie_colours<a class="anchor" aria-label="anchor" href="#arg-pie-colours"></a></dt>
<dd><p>A character vector indicating the colours for the slices
in the pie-glyphs. <br>
If left NULL, the colour blind friendly colours will be
for the pie-glyph slices.</p></dd>


<dt id="arg-pie-radius">pie_radius<a class="anchor" aria-label="anchor" href="#arg-pie-radius"></a></dt>
<dd><p>A numeric value specifying the radius (in cm) for the
pie-glyphs. Default is 0.3 cm.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A boolean variable indicating whether to plot confidence intervals associated with
the effect of species increase or decrease</p></dd>


<dt id="arg-average">average<a class="anchor" aria-label="anchor" href="#arg-average"></a></dt>
<dd><p>A boolean value indicating whether to add a line describing the "average"
effect of variable increase or decrease. The average is calculated at the
median value of any variables not specified.</p></dd>


<dt id="arg-nrow">nrow<a class="anchor" aria-label="anchor" href="#arg-nrow"></a></dt>
<dd><p>Number of rows in which to arrange the final plot
(when `add_var` is specified).</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Number of columns in which to arrange the final plot
(when `add_var` is specified).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggmultiplot (ggplot if single plot is returned) class object or data-frame (if `plot = FALSE`)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com/" class="external-link">DImodels</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fl">0</span>, data <span class="op">=</span> <span class="va">sim1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create data for visualising effect of adding species 1 to</span></span></span>
<span class="r-in"><span><span class="co">## the original communities in the data</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="visualise_effects_data.html">visualise_effects_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim1</span><span class="op">[</span><span class="va">sim1</span><span class="op">$</span><span class="va">block</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                                    prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    var_interest <span class="op">=</span> <span class="st">"p1"</span>,</span></span>
<span class="r-in"><span>                                    effect <span class="op">=</span> <span class="st">"increase"</span>, model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create plot</span></span></span>
<span class="r-in"><span><span class="fu">visualise_effects_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created plot.</span>
<span class="r-plt img"><img src="visualise_effects_plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Show specific curves with prediction intervals</span></span></span>
<span class="r-in"><span><span class="va">subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="custom_filter.html">custom_filter</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">.Group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">visualise_effects_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset</span>, prop <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created plot.</span>
<span class="r-plt img"><img src="visualise_effects_plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Do not show average effect line</span></span></span>
<span class="r-in"><span><span class="fu">visualise_effects_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset</span>,</span></span>
<span class="r-in"><span>                       se <span class="op">=</span> <span class="cn">TRUE</span>, average <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created plot.</span>
<span class="r-plt img"><img src="visualise_effects_plot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Change colours of the pie-glyph slices</span></span></span>
<span class="r-in"><span><span class="fu">visualise_effects_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">subset</span>,</span></span>
<span class="r-in"><span>                       pie_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen"</span>, <span class="st">"darkolivegreen1"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"steelblue4"</span>, <span class="st">"steelblue1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created plot.</span>
<span class="r-plt img"><img src="visualise_effects_plot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#' ## Simultaneously create multiple plots for additional variables</span></span></span>
<span class="r-in"><span><span class="va">sim1</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">$</span><span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod</span>, <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">sim1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="visualise_effects_data.html">visualise_effects_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">13</span><span class="op">)</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                    prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span>, <span class="st">"p3"</span>, <span class="st">"p4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    var_interest <span class="op">=</span> <span class="st">"p3"</span>,</span></span>
<span class="r-in"><span>                                    model <span class="op">=</span> <span class="va">new_mod</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>                                    add_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"block"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Finished data preparation.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">visualise_effects_plot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>,</span></span>
<span class="r-in"><span>                       average <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                       pie_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen"</span>, <span class="st">"darkolivegreen1"</span>,</span></span>
<span class="r-in"><span>                                       <span class="st">"steelblue4"</span>, <span class="st">"steelblue1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Created all plots.</span>
<span class="r-plt img"><img src="visualise_effects_plot-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rishabh Vishwakarma, Caroline Brophy, Laura Byrne, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

